# 営業向けコミュニケーションアプリ 要件定義書

## 1. 概要

### 1.1 システム概要
TwilioとSalesforceを活用した営業担当者向けのモバイルコミュニケーションアプリケーション。顧客管理、通話、メッセージング、活動記録を一元管理し、営業活動の効率化を支援する。

### 1.2 対象ユーザー
- 営業担当者
- 営業マネージャー

### 1.3 技術構成
- フロントエンド: Vanilla JavaScript (SPA)
- 通話基盤: Twilio
- CRM連携: Salesforce
- 録音サービス: YouWire（外部サービス）

---

## 2. 画面構成

### 2.1 画面一覧

| No | 画面ID | 画面名 | 概要 |
|----|--------|--------|------|
| 1 | login | ログイン画面 | ユーザー認証 |
| 2 | two-factor | 2段階認証画面 | SMS/メール認証コード入力 |
| 3 | home | ホーム画面 | ダッシュボード、KPI表示 |
| 4 | notifications | 通知一覧画面 | システム通知の一覧・既読管理 |
| 5 | tasks | タスク/リマインダー画面 | フォローアップ予定の管理 |
| 6 | customers | 顧客一覧画面 | 顧客検索・一覧表示 |
| 7 | customer-detail | 顧客詳細画面 | 顧客情報・対応履歴表示 |
| 8 | phone | 電話画面 | 通話履歴・発信 |
| 9 | dial | ダイヤル画面 | 電話番号入力・発信 |
| 10 | calling | 発信中画面 | 発信中の状態表示 |
| 11 | incoming | 着信画面 | 着信通知・応答 |
| 12 | talk | 通話中画面 | 通話操作・AIリアルタイム分析 |
| 13 | call-end | 通話終了画面 | AI要約・推奨アクション表示 |
| 14 | call-detail | 通話詳細画面 | 録音・文字起こし閲覧 |
| 15 | activity-registration | 活動登録画面 | 通話後の活動記録 |
| 16 | messages | メッセージ画面 | 会話一覧 |
| 17 | messaging | メッセージング画面 | 個別チャット |
| 18 | settings | 設定画面 | アプリ設定 |
| 19 | user-profile | ユーザープロフィール画面 | ユーザー情報・セキュリティ設定 |

### 2.2 画面遷移図

```
[ログイン] → [2段階認証] → [ホーム]
                              ├── [通知一覧]
                              ├── [タスク/リマインダー]
                              │
[ホーム] ←→ [顧客] ←→ [電話] ←→ [メッセージ] ←→ [設定]
   │           │         │           │              │
   │           │         │           │              └── [ユーザープロフィール]
   │           │         │           │
   │           │         │           └── [メッセージング]
   │           │         │
   │           │         ├── [ダイヤル] → [発信中] → [通話中] → [通話終了] → [活動登録]
   │           │         │                              ↑
   │           │         └── [通話詳細]                  │
   │           │                                         │
   │           └── [顧客詳細] ──────────────────────────┘
   │                   │
   │                   └── [活動登録]
   │
   └── [着信] → [通話中] → [通話終了] → [活動登録]
```

---

## 3. 機能一覧

### 3.1 認証機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| AUTH-01 | ログイン | メールアドレス・パスワードによる認証 |
| AUTH-02 | 2段階認証 | SMS/メール/認証アプリによるコード認証 |
| AUTH-03 | パスワード表示切替 | パスワード入力欄の表示/非表示切替 |
| AUTH-04 | ログアウト | セッション終了 |

### 3.2 ホーム機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| HOME-01 | KPI表示 | 本日の通話数・商談数・受注見込表示 |
| HOME-02 | 要対応アラート | 高優先度通知の表示 |
| HOME-03 | 今日のタスク | 本日期限のタスクサマリー表示 |
| HOME-04 | 直近アクティビティ | 最近の顧客対応履歴表示 |
| HOME-05 | 通知バッジ | 未読通知数の表示 |

### 3.3 通知機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| NOTIF-01 | 通知一覧表示 | システム通知の一覧表示 |
| NOTIF-02 | 既読管理 | 個別/一括既読処理 |
| NOTIF-03 | 通知タイプ分類 | リスク警告/システム/情報の分類表示 |
| NOTIF-04 | 優先度表示 | 高/中/低の優先度による視覚的区別 |

### 3.4 タスク/リマインダー機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| TASK-01 | タスク一覧表示 | 期限切れ/今日/今後の予定を区分表示 |
| TASK-02 | タスク完了 | タスクの完了チェック |
| TASK-03 | 顧客直接発信 | タスク一覧から顧客へ直接発信 |
| TASK-04 | タスク作成 | 活動登録時にリマインダー設定 |

### 3.5 顧客管理機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| CUST-01 | 顧客一覧表示 | 顧客リストの表示 |
| CUST-02 | 顧客検索 | 名前・会社名での検索 |
| CUST-03 | 顧客詳細表示 | 顧客情報・連絡先・商談情報表示 |
| CUST-04 | リスクレベル表示 | 高/中/低のリスクレベル表示 |
| CUST-05 | ステータス表示 | Hot/Warm/Coldの商談ステータス表示 |
| CUST-06 | 対応履歴表示 | 過去の通話・活動履歴のタイムライン表示 |
| CUST-07 | 録音再生リンク | 対応履歴から録音URLへアクセス |
| CUST-08 | 文字起こし表示 | 対応履歴から文字起こし閲覧 |

### 3.6 通話機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| CALL-01 | 発信 | 顧客への電話発信 |
| CALL-02 | 着信 | 着信通知・応答・拒否 |
| CALL-03 | 通話中操作 | ミュート/スピーカー/保留/終了 |
| CALL-04 | 通話履歴表示 | 発信/着信/不在着信の履歴表示 |
| CALL-05 | 録音再生 | YouWire録音URLへのリンク |
| CALL-06 | AIリアルタイム分析 | 通話中のキーワード検出・リスク警告 |
| CALL-07 | AI文字起こし要約 | 通話終了後の自動要約生成 |
| CALL-08 | 推奨アクション提案 | AIによる次のアクション提案 |

### 3.7 活動登録機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| ACT-01 | 活動登録 | 通話後の活動記録作成 |
| ACT-02 | AI要約自動入力 | 文字起こし要約のノート欄自動セット |
| ACT-03 | 通話結果選択 | 接続/不在/話中/折返しの選択 |
| ACT-04 | 次のアクション選択 | フォローアップ電話/見積書送付等の選択 |
| ACT-05 | リマインダー設定 | フォローアップ日時の設定 |
| ACT-06 | クイック日時選択 | 明日/3日後/1週間後のワンタップ選択 |

### 3.8 メッセージング機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| MSG-01 | 会話一覧表示 | LINE/SMSの会話リスト表示 |
| MSG-02 | 未読バッジ | 未読メッセージ数の表示 |
| MSG-03 | チャット表示 | 個別会話のメッセージ表示 |
| MSG-04 | メッセージ送信 | テキストメッセージの送信 |
| MSG-05 | チャネル表示 | LINE/SMSのチャネル種別表示 |

### 3.9 設定機能

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| SET-01 | プロフィール表示 | ユーザー情報の表示・編集 |
| SET-02 | 2段階認証設定 | 認証方法の設定・有効/無効切替 |
| SET-03 | ログイン履歴 | 過去のログイン履歴表示 |
| SET-04 | 通知設定 | 通知のON/OFF設定 |
| SET-05 | パスワード変更 | パスワードの変更 |

---

## 4. 機能仕様

### 4.1 ログイン画面 (login)

#### 4.1.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| メールアドレス入力欄 | テキスト | ユーザーのメールアドレス |
| パスワード入力欄 | パスワード | ユーザーのパスワード |
| パスワード表示ボタン | アイコンボタン | パスワードの表示/非表示切替 |
| ログインボタン | ボタン | 認証実行 |
| パスワード忘れリンク | リンク | パスワードリセットへ遷移 |

#### 4.1.2 処理フロー
1. メールアドレス・パスワードを入力
2. ログインボタンをタップ
3. 認証成功時、2段階認証画面へ遷移
4. 認証失敗時、エラーメッセージ表示

---

### 4.2 2段階認証画面 (two-factor)

#### 4.2.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| 認証コード入力欄 | 6桁入力 | 6つの個別入力フィールド |
| 認証方法表示 | テキスト | SMS/メール/認証アプリ |
| コード再送ボタン | ボタン | 認証コードの再送信 |
| 別の方法リンク | リンク | 認証方法の変更 |

#### 4.2.2 処理フロー
1. 6桁の認証コードを入力（自動フォーカス移動）
2. 6桁入力完了で自動認証
3. 認証成功時、ホーム画面へ遷移
4. ペースト対応（6桁コードの一括貼り付け）

---

### 4.3 ホーム画面 (home)

#### 4.3.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| 通知アイコン | アイコンボタン | 通知一覧へ遷移、未読バッジ表示 |
| 今日のタスクセクション | カード | タスクサマリー・プレビュー |
| 要対応セクション | カード | 高優先度通知 |
| 本日のKPIセクション | カード | 通話数/商談数/受注見込 |
| 直近アクティビティ | リスト | 最近の顧客対応 |

#### 4.3.2 タスクサマリー表示
- 期限切れタスク数（赤色）
- 本日対応タスク数（黄色）
- 直近2件のタスクプレビュー

---

### 4.4 通知一覧画面 (notifications)

#### 4.4.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| すべて既読ボタン | ボタン | 全通知を既読にする |
| 未読セクション | リスト | 未読通知の一覧 |
| 既読セクション | リスト | 既読通知の一覧 |
| 通知アイテム | リスト項目 | アイコン/メッセージ/時間/未読ドット |

#### 4.4.2 通知タイプ
| タイプ | アイコン | 色 | 用途 |
|--------|----------|-----|------|
| risk | 警告三角 | 赤 | NGワード検出、リスク上昇 |
| system | チェック | 緑 | 承認完了、システム通知 |
| info | 情報 | 青 | 新規リード、目標達成 |

---

### 4.5 タスク/リマインダー画面 (tasks)

#### 4.5.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| 期限切れセクション | リスト | 期限超過タスク（赤色） |
| 今日セクション | リスト | 本日期限タスク |
| 今後の予定セクション | リスト | 将来のタスク |
| タスクアイテム | リスト項目 | チェック/タイプ/顧客/期日/発信ボタン |

#### 4.5.2 タスクタイプ
| タイプID | 表示名 | アイコン |
|----------|--------|----------|
| follow_up_call | フォローアップ電話 | 電話 |
| send_quote | 見積書送付 | ファイル |
| send_materials | 資料送付 | 送信 |
| schedule_meeting | 打ち合わせ設定 | カレンダー |
| close_deal | 契約締結 | チェック |

---

### 4.6 顧客詳細画面 (customer-detail)

#### 4.6.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| 顧客情報セクション | カード | 名前/会社名/リスクレベル |
| アクションボタン | ボタン群 | 電話/メッセージ/メール/活動登録 |
| 顧客情報タブ | タブ | 連絡先/商談情報 |
| 対応履歴タブ | タブ | 活動タイムライン |

#### 4.6.2 対応履歴タイムライン
- 日付ごとのグループ表示
- 各活動に録音/文字起こしボタン表示
- 通話時間・結果の表示

---

### 4.7 通話終了画面 (call-end)

#### 4.7.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| 顧客情報 | 表示 | アバター/名前/会社名/通話時間 |
| YouWire録音リンク | リンクボタン | 外部録音サービスへのリンク |
| AI要約カード | カード | 文字起こし要約/キーワード/推奨アクション |
| 活動登録ボタン | ボタン | 活動登録画面へ遷移 |
| スキップボタン | ボタン | ホームへ戻る |

#### 4.7.2 AI文字起こし要約
- 通話内容の自動要約
- 検出キーワードのタグ表示
- 推奨アクション（例：フォローアップ電話（1週間後））

---

### 4.8 活動登録画面 (activity-registration)

#### 4.8.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| 顧客情報 | 表示 | 名前/会社名 |
| 文字起こし表示 | 折りたたみ | 全文表示/要約表示切替 |
| YouWire録音リンク | リンク | 録音再生へのリンク |
| ノート入力欄 | テキストエリア | AI要約が自動入力 |
| 通話結果選択 | セレクト | 接続/不在/話中/折返し |
| 次のアクション選択 | セレクト | フォローアップ種別 |
| リマインダー設定 | トグル+日時選択 | ON/OFF + 日時指定 |
| 保存ボタン | ボタン | 活動保存 |

#### 4.8.2 リマインダー設定
- トグルでON/OFF切替
- クイック選択：明日/3日後/1週間後
- カスタム日時選択
- プレビュー表示（例：2025年1月31日 金曜日 10:00 にリマインド）

#### 4.8.3 通話結果オプション
| 値 | 表示名 |
|----|--------|
| connected | 接続 |
| no_answer | 不在 |
| busy | 話中 |
| callback | 折返し希望 |

---

### 4.9 通話詳細画面 (call-detail)

#### 4.9.1 画面要素
| 要素 | 種別 | 説明 |
|------|------|------|
| 通話情報 | 表示 | 顧客名/日時/通話時間 |
| YouWire録音リンク | リンクボタン | 外部録音サービスへのリンク |
| 文字起こし | テキスト | スピーカー別の会話表示 |

---

## 5. データ構造

### 5.1 ユーザー (mockUser)
```javascript
{
  id: Number,
  name: String,
  email: String,
  phone: String,
  department: String,
  position: String,
  avatar: String | null,
  twoFactorEnabled: Boolean,
  twoFactorMethod: 'sms' | 'email' | 'app',
  lastLogin: String,
  loginHistory: Array
}
```

### 5.2 顧客 (mockCustomers)
```javascript
{
  id: Number,
  name: String,
  company: String,
  phone: String,
  status: 'hot' | 'warm' | 'cold',
  lastContact: String,
  riskLevel: 'high' | 'medium' | 'low',
  amount: String,
  verified: Boolean
}
```

### 5.3 タスク (mockTasks)
```javascript
{
  id: Number,
  customerId: Number,
  customerName: String,
  company: String,
  type: String,           // follow_up_call, send_quote, etc.
  title: String,
  note: String,
  dueDate: String,        // YYYY-MM-DD（相対日付で動的生成）
  dueTime: String,        // HH:MM
  createdAt: String,
  completed: Boolean,
  activityId: Number | null
}
```

### 5.4 通知 (mockNotifications)
```javascript
{
  id: Number,
  type: 'risk' | 'system' | 'info',
  message: String,
  time: String,           // 相対時間表示用
  timestamp: String,      // ISO形式
  priority: 'high' | 'medium' | 'low',
  read: Boolean
}
```

### 5.5 活動 (mockActivities)
```javascript
{
  id: Number,
  customerId: Number,
  customerName: String,
  company: String,
  type: String,
  result: String,
  note: String,
  nextAction: String,
  duration: String,
  recordingUrl: String,
  transcription: Object | null,
  createdAt: String
}
```

---

## 6. 外部連携

### 6.1 Twilio連携
- 発信/着信処理
- 通話制御（保留/転送/終了）
- 通話録音

### 6.2 Salesforce連携
- 顧客情報の取得
- 活動履歴の登録
- 商談情報の更新

### 6.3 YouWire連携
- 録音データの保存
- 録音再生URLの提供
- URL形式: `https://softbank.youwire.jp/recording/{recordingId}`

### 6.4 AI連携
- リアルタイム文字起こし
- 通話要約生成
- キーワード検出
- リスク警告（NGワード検出）
- 推奨アクション提案

---

## 7. 非機能要件

### 7.1 対応デバイス
- iOS: Safari
- Android: Chrome
- 画面サイズ: 最大430px（モバイルファースト）

### 7.2 セキュリティ
- 2段階認証必須
- セッション管理
- ログイン履歴の記録

### 7.3 UI/UX
- 固定ヘッダー/フッターナビゲーション
- スワイプ/タップ操作対応
- 視覚的なステータス表示（色分け）

---

## 8. 通知とタスクのすみわけ

### 8.1 通知（システム通知）
| 特徴 | 説明 |
|------|------|
| 生成元 | システムが自動生成 |
| 内容 | アラート、警告、情報通知 |
| 例 | NGワード検出、リスク上昇、契約承認、新規リード |
| アクション | 既読にする、詳細確認 |

### 8.2 タスク/リマインダー（ユーザー設定）
| 特徴 | 説明 |
|------|------|
| 生成元 | ユーザーが手動設定 |
| 内容 | フォローアップ予定、期日付きアクション |
| 例 | 1週間後にフォローアップ電話、見積書送付 |
| アクション | 完了チェック、顧客へ発信、詳細確認 |

---

## 改訂履歴

| 版 | 日付 | 変更内容 |
|----|------|----------|
| 1.0 | 2025-01-24 | 初版作成 |
